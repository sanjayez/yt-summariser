name: Code Quality Checks

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main, develop ]

jobs:
  lint-and-type-check:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Install uv
      uses: astral-sh/setup-uv@v4
      with:
        version: "latest"

    - name: Set up Python
      run: uv python install 3.12

    - name: Install dependencies
      run: uv sync --all-extras --dev

    - name: Run Ruff linting
      run: |
        echo "ðŸ” Running Ruff linter..."
        uv run ruff check . --output-format=github

    - name: Run Ruff formatting check
      run: |
        echo "ðŸŽ¨ Checking Ruff formatting..."
        uv run ruff format --check .

    # - name: Run Ty type checking (temporarily disabled)
    #   run: |
    #     echo "ðŸ”§ Running Ty type checker..."
    #     uv run ty check .

    - name: Generate summary
      if: always()
      run: |
        echo "## ðŸ“Š Code Quality Summary (2025)" >> $GITHUB_STEP_SUMMARY
        echo "- âœ… Linting: Completed with Ruff" >> $GITHUB_STEP_SUMMARY
        echo "- âœ… Formatting: Completed with Ruff" >> $GITHUB_STEP_SUMMARY
        echo "- â¸ï¸ Type Checking: Temporarily disabled (Ty config to be fixed)" >> $GITHUB_STEP_SUMMARY
        echo "- âš¡ Package Management: uv" >> $GITHUB_STEP_SUMMARY
